画图介绍了为什么写驱动
![[Pasted image 20240116142711.png]]

## 介绍了驱动的组成
1. 申请设备号
2. 创建设备文件（结点）
3. 硬件初始化--地址映射/中断申请
4. 实现操作设备的接口函数

linux的内核驱动程序运行在虚拟内存之中，linux不能直接操作物理内存来点灯，需要进行物理地址到虚拟地址的映射

编写linux驱动对硬件掌握的要求不高，只需要能有20%左右的硬件知识即可

## 介绍编写linux点灯的过程
1. 查看原理图
	先理清芯片与外设之间的接线
2. 看芯片手册
	查找对应的芯片的寄存器并写代码进行配置，以控制对应的外设
	截图查找相关的寄存器的内容，以便后来编写代码的使用
3. 硬件初始化
4. 实现设备操作接口

## 编写驱动组成部分的代码
1. 申请设备号
介绍了使用`register_chrdev`函数静态分配设备号与动态分配设备号
我们可以在`/proc/devices`中查看所有的linux设备以及其设备号，可以使用`cat /proc/devices`来显示linux设备及其设备号

2. 创建设备文件（结点）
手动创建：创建设备节点的shell命令![[Pasted image 20240116152859.png]]
在驱动中创建：介绍了使用device_create函数来创建一个设备文件
介绍了主设备号与次设备号与设备号之间的关系

3. 进行硬件的初始化
需要将硬件的地址映射到虚拟地址
使用ioremap函数来进行地址的一个映射

4. 实现操作设备的接口函数
这里就是封装led点亮熄灭的操作寄存器的函数

之后再查看老师的代码来好好确定一下

## 介绍linux程序开发的基本原则
![[Pasted image 20240116165234.png]]
应用程序实现使用基本功能的步骤
驱动程序实现基本功能
应用程序的数据传递给内核，需要使用write
内核的数据传递给应用程序，需要使用read
